/*!
* hoard.min.js
*
* hoard 0.0.1
*
* A simple, expiring memory cache implementation for JavaScript
*
* Copyright 2015 Bryn Mosher (https://github.com/BrynM)
* License: GPLv3
*
* Build:
*   Bryn Mosher on myakka
*   https://github.com/BrynM/hoard.git
*   0.0.1-1442731871
*   master a501dd31319018376cfcffa89823fcd4863fc451
*   Sun, 20 Sep 2015 06:51:11 GMT
*   Sat Sep 19 2015 23:51:11 GMT-0700 (Pacific Daylight Time)
*/
(function(){var a=typeof HOARD_NAME==='string'&&HOARD_NAME.length>0?HOARD_NAME:'hoard';var b=typeof HOARD_CHAR==='string'&&HOARD_CHAR.length>0?HOARD_CHAR:'Ã¼';var c=typeof HOARD_PARENT==='object'?HOARD_PARENT:undefined;var d=typeof HOARD_MAIN_OPTS==='object'?HOARD_MAIN_OPTS:undefined;var e={};var f={};var g=false;var h;var i=[];var j={};var k=(new Date).valueOf()/1e3*Math.random()*100*Math.random();function HoardStore(a,b){var c={};var d={};var e=false;var g;var h=m(b);var l=this;var n;function p(a,b){var c={cancelable:true,currentTarget:this,target:this};return o(a,b,c)}function q(){if(g){return}g=setTimeout(function(){l.garbage();g=null;q()},h.gcInterval*1e3)}this.del=function r(a){var b;if(typeof c[a]!=='undefined'){c[a]=b;d[a]=b}return typeof d[a]==='undefined'};this.garbage=function y(){var a=w;var b;if(e){return}e=true;p('hoardGcBegin',this);for(b in d){if(d[b]<w){this.del(b)}}e=false;p('hoardGcEnd',this)};this.get=function z(a){var b=x(a,h.prefix);if(!b){return}if(typeof c[b]!=='undefined'){if(w()>d[b]){this.del(b);return}if(h.useJSON){return JSON.parse(c[b])}return c[b]}};this.keys=function A(){var a;var b=[];for(a in c){if(c.hasOwnProperty(a)){b.push(''+a)}}return b};this.on=function B(a,b){return bind_event(a,b)};this.options=function C(){var a;var b={};for(a in h){if(h.hasOwnProperty(a)){switch(typeof h[a]){case'object':if(h[a]===null){b[a]=null}break;case'number':case'string':b[a]=''+h[a];break}}}return b};this.set_opt=function D(a,b){if(!v(a)||!h.hasOwnProperty(a)||is_empty(b)){return}if(u(f[a])&&s(f[a].check)){h[a]=f[a].check(b,h[iter].val);return this.options()[a]}};this.set=function E(a,b,e){var f=t(e)?parseInt(e,10):h.lifeDefault;var g=x(a,h.prefix);if(!g){return}if(typeof b==='undefined'){this.del(g)}if(f>h.lifeMax){f=h.lifeMax}c[g]=h.useJSON?JSON.stringify(b):b;d[g]=parseInt(w()+f,10);return this.get(g)};this.stringify=function F(a,b){var e={};var f;for(f in c){if(f in d){e[f]=[JSON.parse(c[f]),d[f]]}}return JSON.stringify(e,a,b)};n=i.push(this)-1;this.hoard=v(a)?''+a:'';this.storeId=parseInt(n,10);this.hoardId=k+'_'+n;j[this.hoard]=n;q()}function l(a,b){var c=hoard.get_store(a);var d=Array.prototype.slice.call(arguments).slice(2);if(c&&s(c[b])){return c[b].apply(c,d)}}function m(a){var b;var c={};for(b in f){if(f.hasOwnProperty(b)&&u(f[b])&&s(f[b].check)){c[b]=f[b].check(f[b].val)}}if(u(a)){for(b in c){if(f.hasOwnProperty(b)){c[b]=f[b].check(a[b],f[b].val)}}}return c}function n(a,b){return document.addEventListener(a,b)}function o(a,b,c){var d=new Event(a,c);d.hoardData=b;console.log('ev',[d.type,d.hoardData.hoard,d]);return document.dispatchEvent(d,b)}function p(a){}function q(a,b){if(c){c[a]=b;return c[a]}if(g){module.exports[a]=b;return module.exports[a]}if(u(window)){window[a]=b;return window[a]}}function r(a){return typeof a==='boolean'}function s(a){return typeof a==='function'}function t(a,b){b=typeof b==='undefined'?true:false;return typeof a==='number'&&!isNaN(a)&&(!b||a>0)}function u(a){return typeof a==='object'&&a!==null}function v(a,b){b=typeof b==='undefined'?true:false;return typeof a==='string'&&(!b||a.length>0)}function w(){return parseInt((new Date).valueOf()/1e3,10)}function x(a,b){return v(a)||!t(a)?b+''+a:false}e.del_all=function z(a){var b;var c={};for(b in j){c[b]=l(b,'del',a)}return c};e.store=function A(a,b){if(!v(a)){return h}if(a in j&&u(i[j[a]])){return i[j[a]]}return new HoardStore(a,b)};e.get_all=function B(a){var b;var c={};for(b in j){c[b]=l(b,'get',a)}return c};e.set_all=function C(a,b,c){var d;var e={};for(d in j){e[d]=l(d,'set',a,b,c)}return e};f.prefix={val:'',check:function(a,b){return v(a)?''+a:v(b)?b:''}};f.lifeMax={val:31536e3,check:function(a,b){return t(a)?parseInt(a,10):t(b)?b:0}};f.lifeDefault={val:300,check:function(a,b){return t(a)?parseInt(a,10):t(b)?b:0}};f.gcInterval={val:30,check:function(a,b){return t(a,true)?parseInt(a,10):t(b)?b:0}};f.useJSON={val:true,check:function(a,b){return a?true:r(b)?b:true}};try{g=this.obj(process)&&this.str(process.version)&&this.obj(exports);g=g?process.version:false}catch(y){g=false}h=new HoardStore('main',d);q(a,e);q(b,e.store)})();