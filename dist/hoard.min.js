/*!
* Hoard
* hoard.min.js v0.0.3
* A simple, expiring memory cache implementation for JavaScript
* © 2015 Bryn Mosher (https://github.com/BrynM) GPL-3.0
* Build: BrynM on myakka 0.0.3-1443588226 0.0.3-docs c3ac963 2015-09-30T04:43:46.931Z
*/
(function(){var a=typeof HOARD_NAME==='string'&&HOARD_NAME.length>0?HOARD_NAME:'hoard';var b=typeof HOARD_CHAR==='string'&&HOARD_CHAR.length>0?HOARD_CHAR:'ü';var c=typeof HOARD_PARENT==='object'?HOARD_PARENT:undefined;var d=typeof HOARD_MAIN_OPTS==='object'?HOARD_MAIN_OPTS:undefined;var e={};var f={};var g=false;var h;var i=[];var j={};var k=(new Date).valueOf()/1e3*Math.random()*100*Math.random();var l={};function HoardStore(a,b){var c={};var d={};var e=false;var g;var h;var l;var m=undefined;var n=p(b);var o=this;var q;var t;var u=s(n.storage);var v=['storage'];function w(a,b){var c={cancelable:true,currentTarget:this,target:this};return r(a,b,c)}function x(a){return parseInt(E()+a,10)}function D(){if(g){return}g=setTimeout(function(){o.garbage();g=null;D()},n.gcInterval*1e3)}function F(a){return B(a)||z(a)?n.prefix+''+a:false}this.clear=function a(){d={};c={}};this.del=function a(b){var e=F(b);if(C(d[e])){d[e]=m}if(C(c[e])){c[e]=m}return!C(c[e])};this.expire=function a(b,d){var e=z(d)?parseInt(d,10):null;var f=F(b);if(!f){return}if(e===null||e<1){return this.del(b)}if(typeof c[f]!=='undefined'){c[f]=x(e);return c[f]}};this.expire_at=function a(b,d){var e=z(d)?parseInt(d,10):null;var f=F(b);var g=E();if(!f){return}if(e===null||e<=g){return this.del(b)}if(typeof c[f]!=='undefined'){c[f]=e;return c[f]}};this.garbage=function a(){var b=E;var d;if(e){return false}e=true;w('hoardGcBegin',this);for(d in c){if(c[d]<E){this.del(d)}}e=false;w('hoardGcEnd',this);return true};this.get=function a(b){var e=F(b);if(!e){return}if(C(d[e])){if(!C(c[e])){d[e]=m;return}if(E()>=c[e]){this.del(b);return}return u.dec(d[e])}};this.keys=function a(){var b;var c=[];for(b in d){if(d.hasOwnProperty(b)){if(typeof d[b]!=='undefined'){c.push(''+b)}}}return c};this.get_name=function a(){return''+l};this.get_store_id=function a(){return parseInt(q,10)};this.options=function a(){var b;var c={};for(b in n){if(n.hasOwnProperty(b)){switch(typeof n[b]){case'object':if(n[b]===null){c[b]=null}break;case'number':case'string':c[b]=''+n[b];break}}}return c};this.set_option=function a(b,c){if(!B(b)||!n.hasOwnProperty(b)){return}if(v.indexOf(b)>-1){throw'Cannot set read-only option "'+b+'"!!!'}if(A(f[b])&&y(f[b].check)){n[b]=f[b].check(c,n[iter].val);return this.options()[b]}};this.set=function a(b,e,f){var g=z(f)?parseInt(f,10):n.lifeDefault;var h=F(b);if(!h){return}if(typeof e==='undefined'){this.del(b)}if(g>n.lifeMax){g=n.lifeMax}d[h]=u.enc(e);c[h]=x(g);return this.get(b)};this.get_hoard_id=function a(){return''+h};this.stringify=function a(b,e){var f={};var g;for(g in d){if(C(d[g])&&C(c[g])){f[g]=[JSON.parse(d[g]),''+c[g]]}}return JSON.stringify(f,b,e)};t=i.push(this)-1;l=B(a)?''+a:'';q=parseInt(t,10);h=k+'_'+t;this.hoard=''+l;this.storeId=parseInt(q,10);this.hoardId=''+h;j[l]=t;D()}HoardStore.prototype.toString=function(){return'[Object HoardStore]'};HoardStore.prototype.valueOf=function(){return this.stringify()};HoardStore.prototype.keys=function(){return this.keys()};function m(a,b){var c=e.store(a);var d=Array.prototype.slice.call(arguments).slice(2);if(c&&y(c[b])){return c[b].apply(c,d)}}function n(a){var b;var c={};var d;for(b in j){d=Array.prototype.slice.call(arguments);d.shift();d.unshift(a);d.unshift(b);c[b]=m.apply(m,d)}return c}function o(a){if(A(a)){return Object.keys(a).length}return 0}function p(a){var b;var c={};for(b in f){if(f.hasOwnProperty(b)&&A(f[b])&&y(f[b].check)){c[b]=f[b].check(f[b].val)}}if(A(a)){for(b in c){if(f.hasOwnProperty(b)){c[b]=f[b].check(a[b],f[b].val)}}}return c}function q(a,b){return document.addEventListener(a,b)}function r(a,b,c){var d=new Event(a,c);d.hoardData=b;return document.dispatchEvent(d,b)}function s(a){if(B(a)&&a in l){return l[a]}}function t(){var a=[];var b;for(b in l){if(B(b)&&y(l[b].dec)&&y(l[b].enc)){a.push(''+b)}}a.sort();return a}function u(a){}function v(a,b){if(c){c[a]=b;return c[a]}if(g){module.exports[a]=b;return module.exports[a]}if(A(window)){window[a]=b;return window[a]}}function w(a,b){return Object.prototype.toString.call(a)==='[object Array]'&&(z(b)?a.length>=b:true)}function x(a){return typeof a==='boolean'}function y(a){return typeof a==='function'}function z(a,b){b=typeof b==='undefined'?true:false;return typeof a==='number'&&!isNaN(a)&&(!b||a>0)}function A(a){return typeof a==='object'&&a!==null}function B(a,b){b=typeof b==='undefined'?true:false;return typeof a==='string'&&(!b||a.length>0)}function C(a){return typeof a!=='undefined'&&a!==null}function D(a){var b;if(B(a)){if(a==='main'){throw'You cannot kill the main HoardStore!!!'}if(a in j&&A(i[j[a]])){b=j[a];delete i[j[a]];delete j[a]}}return b}function E(){return parseInt((new Date).valueOf()/1e3,10)}e.add_transform=function a(b,c,d){if(B(b)&&y(c)&&y(d)){l[b]={dec:d,enc:c};return e.get_transforms()}};e.clear_all=function a(){return n('clear')};e.del_all=function a(b){return n('del',b)};e.expire_all=function a(b,c){return n('expire',b,c)};e.expire_all_at=function a(b,c){return n('expire_at',b,c)};e.get_all=function a(b){return n('get',b)};e.get_transforms=function a(){return t()};e.keys_all=function a(){return n('keys')};e.set_all=function a(b,c,d){return n('set',b,c,d)};e.kill=function a(b){return D(b)};e.kill_all=function a(b){var c={};for(iter in j){if(!j.hasOwnProperty(iter)||iter==='main'){continue}c[iter]=D(iter)}return c};e.store=function a(b,c){if(!B(b)){return h}if(b in j&&A(i[j[b]])){return i[j[b]]}return new HoardStore(b,c)};l.json={dec:function(a){return JSON.parse(a)},enc:function(a){return JSON.stringify(a)}};l.plain={dec:function(a){return a},enc:function(a){return a}};f.prefix={val:'',check:function(a,b){return B(a)?''+a:B(b)?b:''}};f.lifeMax={val:31536e3*2,check:function(a,b){return z(a)?parseInt(a,10):z(b)?b:0}};f.lifeDefault={val:300,check:function(a,b){return z(a)?parseInt(a,10):z(b)?b:0}};f.gcInterval={val:180,check:function(a,b){return z(a,true)?parseInt(a,10):z(b)?b:0}};f.storage={val:'json',check:function(a,b){var c=(''+a).trim();var d=B(b)?(''+b).trim():'json';if(c in l){return c}if(d in l){return d}throw'Storage format "'+a+'" does not exist!!!'}};try{g=this.obj(process)&&this.str(process.version)&&this.obj(exports);g=g?process.version:false}catch(a){g=false}if(typeof LZString!=='undefined'&&A(LZString)&&y(LZString.compress)&&y(LZString.decompress)){e.add_transform('lzw',function a(b){return LZString.compress(JSON.stringify(b))},function a(b){return JSON.parse(LZString.decompress(b))})}h=new HoardStore('main',d);v(a,e);v(b,e.store)})();