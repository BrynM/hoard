/*!
* Hoard
* hoard.min.js v0.0.1
* A simple, expiring memory cache implementation for JavaScript
* © 2015 Bryn Mosher (https://github.com/BrynM) GPLv3
* Build: BrynM on myakka 0.0.1-1442821185 master bb128bc 2015-09-21T07:39:45.207Z
*/
(function(){var a=typeof HOARD_NAME==='string'&&HOARD_NAME.length>0?HOARD_NAME:'hoard';var b=typeof HOARD_CHAR==='string'&&HOARD_CHAR.length>0?HOARD_CHAR:'ü';var c=typeof HOARD_PARENT==='object'?HOARD_PARENT:undefined;var d=typeof HOARD_MAIN_OPTS==='object'?HOARD_MAIN_OPTS:undefined;var e={};var f={};var g=false;var h;var i=[];var j={};var k=(new Date).valueOf()/1e3*Math.random()*100*Math.random();function HoardStore(a,b){var c={};var d={};var e=false;var g;var h;var l;var m;var o=n(b);var q=this;var r;function s(a,b){var c={cancelable:true,currentTarget:this,target:this};return p(a,b,c)}function y(a){return parseInt(x()+a,10)}function z(){if(g){return}g=setTimeout(function(){q.garbage();g=null;z()},o.gcInterval*1e3)}function A(a){return w(a)||u(a)?o.prefix+''+a:false}this.clear=function a(){c={};d={}};this.del=function a(b){var e=A(b);var f;if(typeof c[e]!=='undefined'){c[e]=f;d[e]=f}return typeof d[e]==='undefined'};this.expire=function a(b,c){var e=u(c)?parseInt(c,10):null;var f=A(b);if(!f){return}if(e===null||e<1){return this.del(b)}if(typeof d[f]!=='undefined'){d[f]=y(e);return d[f]}};this.expire_at=function a(b,c){var e=u(c)?parseInt(c,10):null;var f=A(b);var g=x();if(!f){return}if(e===null||e<=g){return this.del(b)}if(typeof d[f]!=='undefined'){d[f]=e;return d[f]}};this.garbage=function a(){var b=x;var c;if(e){return}e=true;s('hoardGcBegin',this);for(c in d){if(d[c]<x){this.del(c)}}e=false;s('hoardGcEnd',this);return true};this.get=function a(b){var e=A(b);if(!e){return}if(typeof c[e]!=='undefined'){if(x()>=d[e]){this.del(b);return}if(o.useJSON){return JSON.parse(c[e])}return c[e]}};this.keys=function a(){var b;var d=[];for(b in c){if(c.hasOwnProperty(b)){if(typeof c[b]!=='undefined'){d.push(''+b)}}}return d};this.get_name=function a(){return''+h};this.get_store_id=function a(){return parseInt(l,10)};this.options=function a(){var b;var c={};for(b in o){if(o.hasOwnProperty(b)){switch(typeof o[b]){case'object':if(o[b]===null){c[b]=null}break;case'number':case'string':c[b]=''+o[b];break}}}return c};this.set_option=function a(b,c){if(!w(b)||!o.hasOwnProperty(b)||is_empty(c)){return}if(v(f[b])&&t(f[b].check)){o[b]=f[b].check(c,o[iter].val);return this.options()[b]}};this.set=function a(b,e,f){var g=u(f)?parseInt(f,10):o.lifeDefault;var h=A(b);if(!h){return}if(typeof e==='undefined'){this.del(b)}if(g>o.lifeMax){g=o.lifeMax}c[h]=o.useJSON?JSON.stringify(e):e;d[h]=y(g);return this.get(b)};this.get_hoard_id=function a(){return''+m};this.stringify=function a(b,e){var f={};var g;for(g in c){if(g in d){f[g]=[JSON.parse(c[g]),d[g]]}}return JSON.stringify(f,b,e)};r=i.push(this)-1;h=w(a)?''+a:'';l=parseInt(r,10);m=k+'_'+r;this.hoard=''+h;this.storeId=parseInt(l,10);this.hoardId=''+m;j[h]=r;z()}function l(a,b){var c=e.store(a);var d=Array.prototype.slice.call(arguments).slice(2);if(c&&t(c[b])){return c[b].apply(c,d)}}function m(a){var b;var c={};var d;for(b in j){d=Array.prototype.slice.call(arguments);d.shift();d.unshift(a);d.unshift(b);c[b]=l.apply(l,d)}return c}function n(a){var b;var c={};for(b in f){if(f.hasOwnProperty(b)&&v(f[b])&&t(f[b].check)){c[b]=f[b].check(f[b].val)}}if(v(a)){for(b in c){if(f.hasOwnProperty(b)){c[b]=f[b].check(a[b],f[b].val)}}}return c}function o(a,b){return document.addEventListener(a,b)}function p(a,b,c){var d=new Event(a,c);d.hoardData=b;return document.dispatchEvent(d,b)}function q(a){}function r(a,b){if(c){c[a]=b;return c[a]}if(g){module.exports[a]=b;return module.exports[a]}if(v(window)){window[a]=b;return window[a]}}function s(a){return typeof a==='boolean'}function t(a){return typeof a==='function'}function u(a,b){b=typeof b==='undefined'?true:false;return typeof a==='number'&&!isNaN(a)&&(!b||a>0)}function v(a){return typeof a==='object'&&a!==null}function w(a,b){b=typeof b==='undefined'?true:false;return typeof a==='string'&&(!b||a.length>0)}function x(){return parseInt((new Date).valueOf()/1e3,10)}e.all_clear=function a(){return m('clear')};e.all_del=function a(b){return m('del',b)};e.all_expire=function a(b,c){return m('expire',b,c)};e.all_expire_at=function a(b,c){return m('expire_at',b,c)};e.all_get=function a(b){return m('get',b)};e.all_keys=function a(){return m('keys')};e.all_set=function a(b,c,d){return m('set',b,c,d)};e.store=function a(b,c){if(!w(b)){return h}if(b in j&&v(i[j[b]])){return i[j[b]]}return new HoardStore(b,c)};f.prefix={val:'',check:function(a,b){return w(a)?''+a:w(b)?b:''}};f.lifeMax={val:31536e3,check:function(a,b){return u(a)?parseInt(a,10):u(b)?b:0}};f.lifeDefault={val:300,check:function(a,b){return u(a)?parseInt(a,10):u(b)?b:0}};f.gcInterval={val:30,check:function(a,b){return u(a,true)?parseInt(a,10):u(b)?b:0}};f.useJSON={val:true,check:function(a,b){return a?true:s(b)?b:true}};try{g=this.obj(process)&&this.str(process.version)&&this.obj(exports);g=g?process.version:false}catch(a){g=false}h=new HoardStore('main',d);r(a,e);r(b,e.store)})();