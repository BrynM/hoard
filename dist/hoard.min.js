/*!
* Hoard
* hoard.min.js v0.0.1
* A simple, expiring memory cache implementation for JavaScript
* © 2015 Bryn Mosher (https://github.com/BrynM) GPLv3
* Build: BrynM on myakka 0.0.1-1443174995 master 8e93100 2015-09-25T09:56:35.249Z
*/
(function(){var a=typeof HOARD_NAME==='string'&&HOARD_NAME.length>0?HOARD_NAME:'hoard';var b=typeof HOARD_CHAR==='string'&&HOARD_CHAR.length>0?HOARD_CHAR:'ü';var c=typeof HOARD_PARENT==='object'?HOARD_PARENT:undefined;var d=typeof HOARD_MAIN_OPTS==='object'?HOARD_MAIN_OPTS:undefined;var e={};var f={};var g=false;var h;var i=[];var j={};var k=(new Date).valueOf()/1e3*Math.random()*100*Math.random();function HoardStore(a,b){var c={};var d={};var e=false;var g;var h;var l;var m=undefined;var n=o(b);var p=this;var r;var s;function t(a,b){var c={cancelable:true,currentTarget:this,target:this};return q(a,b,c)}function A(a){return parseInt(z()+a,10)}function B(){if(g){return}g=setTimeout(function(){p.garbage();g=null;B()},n.gcInterval*1e3)}function C(a){return y(a)||w(a)?n.prefix+''+a:false}this.clear=function a(){d={};c={}};this.del=function a(b){var e=C(b);if(v(d[e])){d[e]=m}if(v(c[e])){c[e]=m}return!v(c[e])};this.expire=function a(b,d){var e=w(d)?parseInt(d,10):null;var f=C(b);if(!f){return}if(e===null||e<1){return this.del(b)}if(typeof c[f]!=='undefined'){c[f]=A(e);return c[f]}};this.expire_at=function a(b,d){var e=w(d)?parseInt(d,10):null;var f=C(b);var g=z();if(!f){return}if(e===null||e<=g){return this.del(b)}if(typeof c[f]!=='undefined'){c[f]=e;return c[f]}};this.garbage=function a(){var b=z;var d;if(e){return false}e=true;t('hoardGcBegin',this);for(d in c){if(c[d]<z){this.del(d)}}e=false;t('hoardGcEnd',this);return true};this.get=function a(b){var e=C(b);if(!e){return}if(v(d[e])){if(!v(c[e])){d[e]=m;return}if(z()>=c[e]){this.del(b);return}if(n.storage=='json'){return JSON.parse(d[e])}if(n.storage=='lzw'){return JSON.parse(LZString.decompress(d[e]))}return d[e]}};this.keys=function a(){var b;var c=[];for(b in d){if(d.hasOwnProperty(b)){if(typeof d[b]!=='undefined'){c.push(''+b)}}}return c};this.get_name=function a(){return''+l};this.get_store_id=function a(){return parseInt(r,10)};this.options=function a(){var b;var c={};for(b in n){if(n.hasOwnProperty(b)){switch(typeof n[b]){case'object':if(n[b]===null){c[b]=null}break;case'number':case'string':c[b]=''+n[b];break}}}return c};this.set_option=function a(b,c){if(!y(b)||!n.hasOwnProperty(b)||is_empty(c)){return}if(x(f[b])&&u(f[b].check)){n[b]=f[b].check(c,n[iter].val);return this.options()[b]}};this.set=function a(b,e,f){var g=w(f)?parseInt(f,10):n.lifeDefault;var h=C(b);if(!h){return}if(typeof e==='undefined'){this.del(b)}if(g>n.lifeMax){g=n.lifeMax}switch(n.storage){case'json':d[h]=JSON.stringify(e);break;case'lzw':d[h]=LZString.compress(JSON.stringify(e));break;default:d[h]=e;break}c[h]=A(g);return this.get(b)};this.get_hoard_id=function a(){return''+h};this.stringify=function a(b,e){var f={};var g;for(g in d){if(v(d[g])&&v(c[g])){f[g]=[JSON.parse(d[g]),''+c[g]]}}return JSON.stringify(f,b,e)};s=i.push(this)-1;l=y(a)?''+a:'';r=parseInt(s,10);h=k+'_'+s;this.hoard=''+l;this.storeId=parseInt(r,10);this.hoardId=''+h;j[l]=s;B()}HoardStore.prototype.toString=function(){return'[Object HoardStore]'};HoardStore.prototype.valueOf=function(){return this.stringify()};HoardStore.prototype.keys=function(){return this.keys()};function l(a,b){var c=e.store(a);var d=Array.prototype.slice.call(arguments).slice(2);if(c&&u(c[b])){return c[b].apply(c,d)}}function m(a){var b;var c={};var d;for(b in j){d=Array.prototype.slice.call(arguments);d.shift();d.unshift(a);d.unshift(b);c[b]=l.apply(l,d)}return c}function n(a){if(x(a)){return Object.keys(a).length}return 0}function o(a){var b;var c={};for(b in f){if(f.hasOwnProperty(b)&&x(f[b])&&u(f[b].check)){c[b]=f[b].check(f[b].val)}}if(x(a)){for(b in c){if(f.hasOwnProperty(b)){c[b]=f[b].check(a[b],f[b].val)}}}return c}function p(a,b){return document.addEventListener(a,b)}function q(a,b,c){var d=new Event(a,c);d.hoardData=b;return document.dispatchEvent(d,b)}function r(a){}function s(a,b){if(c){c[a]=b;return c[a]}if(g){module.exports[a]=b;return module.exports[a]}if(x(window)){window[a]=b;return window[a]}}function t(a){return typeof a==='boolean'}function u(a){return typeof a==='function'}function v(a){return typeof a!=='undefined'&&a!==null}function w(a,b){b=typeof b==='undefined'?true:false;return typeof a==='number'&&!isNaN(a)&&(!b||a>0)}function x(a){return typeof a==='object'&&a!==null}function y(a,b){b=typeof b==='undefined'?true:false;return typeof a==='string'&&(!b||a.length>0)}function z(){return parseInt((new Date).valueOf()/1e3,10)}e.all_clear=function a(){return m('clear')};e.all_del=function a(b){return m('del',b)};e.all_expire=function a(b,c){return m('expire',b,c)};e.all_expire_at=function a(b,c){return m('expire_at',b,c)};e.all_get=function a(b){return m('get',b)};e.all_keys=function a(){return m('keys')};e.all_set=function a(b,c,d){return m('set',b,c,d)};e.store=function a(b,c){if(!y(b)){return h}if(b in j&&x(i[j[b]])){return i[j[b]]}return new HoardStore(b,c)};f.prefix={val:'',check:function(a,b){return y(a)?''+a:y(b)?b:''}};f.lifeMax={val:31536e3,check:function(a,b){return w(a)?parseInt(a,10):w(b)?b:0}};f.lifeDefault={val:300,check:function(a,b){return w(a)?parseInt(a,10):w(b)?b:0}};f.gcInterval={val:30,check:function(a,b){return w(a,true)?parseInt(a,10):w(b)?b:0}};f.storage={val:'json',check:function(a,b){var c=(''+a).toLowerCase().trim();var d=(''+a).toLowerCase().trim();var e=['json','plain','lzw'];if(e.indexOf(c)>-1){return c}if(e.indexOf(d)>-1){return d}return'json'}};try{g=this.obj(process)&&this.str(process.version)&&this.obj(exports);g=g?process.version:false}catch(a){g=false}h=new HoardStore('main',d);s(a,e);s(b,e.store)})();